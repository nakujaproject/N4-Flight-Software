<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>N4 Flight Software: N4 Flight Software</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">N4 Flight Software<span id="projectnumber">&#160;N4</span>
   </div>
   <div id="projectbrief">Flight software used for the N4 flight computers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">N4 Flight Software </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>Welcome to N4 Flight software docs. N4 Flight software is the code used to run N4 rockets at Nakuja Rocket Project. This code is built using FreeRTOS on the Arduino-ESP32 framework. It is designed to run either on AI-Thinker NodeMCU-ESP32 boards or ESP32-DOIT-DEVKIT V1.</p>
<h1><a class="anchor" id="step1"></a>
Major features</h1>
<ul>
<li>This firmare has been improved tremendously from the previous versions and includes the following features:</li>
</ul>
<h2><a class="anchor" id="step2"></a>
Modularity</h2>
<ul>
<li>Most of the code is now contained in separate files each perfoming its own singular task to ensure code maintainability and testing.</li>
</ul>
<h2><a class="anchor" id="step3"></a>
System Logging</h2>
<ul>
<li>We have built a system logger to keep track of each and every operation that the flight computer undertakes. This can be be retrieved later and reviewed for post-flight analysis</li>
</ul>
<h2><a class="anchor" id="step4"></a>
HIL Testing Engine</h2>
<ul>
<li>A hardware-in-the-loop testing engine has been built into the flight software to allow us to "Test Like We Fly". This allows the flight computer to be tested and debugged way before flight day. Using an improvised XMODEM algorithm, we are able to upload test flight data and run necessary integration tests. <dl class="section note"><dt>Note</dt><dd>See Integration and Testing Procedures for more info</dd></dl>
</li>
</ul>
<h2><a class="anchor" id="step5"></a>
Flight data logging</h2>
<ul>
<li>Flight data logging has been improved. Using an onboard SPI Flash memory, we are able log sensor data and flight states.</li>
</ul>
<h2><a class="anchor" id="step6"></a>
Data dump interface</h2>
<ul>
<li>A data dumping hardware interface has been added to ease the retrieval of data post flight data.</li>
</ul>
<h2><a class="anchor" id="step7"></a>
SAFE and FLIGHT modes</h2>
<ul>
<li>To prevent misfires during intergration and testing, this firmware implements SAFE_MODE that among others operations, disables the pyro-charges before POWERED_FLIGHT.</li>
</ul>
<h2><a class="anchor" id="step8"></a>
XBEE, MQTT, LORA, WIFI telemetry selection</h2>
<ul>
<li>For backward and forward compatibility, we implement a method to allow choice of data telemetry protocol being used.</li>
</ul>
<h2><a class="anchor" id="step9"></a>
Double ejection</h2>
<ul>
<li>We implement drogue and main chute ejection algorithms for successful vehicle recovery</li>
</ul>
<h1><a class="anchor" id="install_sec"></a>
Building, Compilation and Downloading.</h1>
<h2><a class="anchor" id="step10"></a>
System requirements</h2>
<p>The following must be installed to build this release: <br  />
</p><ol type="1">
<li>PlatformIO Core. Download the core here: <a href="https://docs.platformio.org/en/latest/core/installation/index.html">PlatformIO Core</a></li>
<li>PlatformIO IDE (recommended on VS Code but you can use IDE of your choice). To install PlatformIO IDE, follow the steps listed here: <a href="https://platformio.org/platformio-ide">PlatformIO IDE</a></li>
<li>Serial Monitor tool e.g. Putty, Ai-Thinker Serial, RealTerm etc</li>
</ol>
<h2><a class="anchor" id="step11"></a>
Building the code</h2>
<ul>
<li>Clone the repo on your local machine <div class="fragment"><div class="line">git clone https://github.com/nakujaproject/N4-Flight-Software.git</div>
</div><!-- fragment --></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>You can also download the folder as a zip file and extract it to a folder of your choice. But we recommend cloning it so you can keep up to date with the remote changes.</dd></dl>
<ul>
<li>Change the directory to <div class="fragment"><div class="line">N4-Flight-Software\n4-flight-software </div>
</div><!-- fragment -->. This is the folder containing <div class="fragment"><div class="line">platformio.ini </div>
</div><!-- fragment --></li>
<li>Install code dependencies <div class="fragment"><div class="line">pio pkg install</div>
</div><!-- fragment --></li>
<li>Build <div class="fragment"><div class="line">pio run </div>
</div><!-- fragment --></li>
<li>Connect your flight computer using a USB cable and make sure it is seen by your PC. It should be listed under Device Manager&gt;Ports, if you are on windows</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>If your ESP32 is note recognized, you have to install USB-TO-TTL chip driver manually. For ESP32 Boards using CH340 chip, download the driver here <a href="https://learn.sparkfun.com/tutorials/how-to-install-ch340-drivers/all">CH340 Driver-SparkFun</a>. Run the driver and it will be automatically installed on your machine. For ESP32 Boards using CP2102 chip, follow the procedure here <a href="https://www.pololu.com/docs/0J7/all">CP2102-driver-POLOLU</a>. Run the driver and it will be automatically installed on your machine.</dd></dl>
<ul>
<li>Upload and run Close any open serial ports connected to that ESP32 and run the command below <div class="fragment"><div class="line">pio run -t upload </div>
</div><!-- fragment --> The firmware will be uploaded to the flight computer</li>
</ul>
<h1><a class="anchor" id="step13"></a>
Hardware, pin assignment and peripherals</h1>
<dl class="section note"><dt>Note</dt><dd>In development</dd></dl>
<h1><a class="anchor" id="step14"></a>
Integration and Testing Procedures</h1>
<dl class="section note"><dt>Note</dt><dd>In development</dd></dl>
<h1><a class="anchor" id="step15"></a>
Contributors</h1>
<p>Our thanks go to the following current and previous avionics team members for their contribution:</p><ol type="1">
<li>Edwin Mwiti</li>
<li>Junn Hope</li>
<li>Jones Kisaka</li>
<li>Ruth</li>
<li>Safa Osman</li>
<li>Tabby Achieng</li>
<li>Sharlyn</li>
<li>Pat</li>
<li>Emmanuel</li>
<li>Fortune</li>
<li>Newton</li>
<li>Rodney</li>
<li>Sammy</li>
<li>Michael Kimani</li>
<li>George Bange</li>
<li>Maisha</li>
<li>Naomi Chesang</li>
<li>Brian Munene</li>
<li>Samson Onyambu</li>
<li>Cate Kabura</li>
<li>Amos Korir</li>
<li>Graig Kipkorir</li>
<li>Jerry Mumo</li>
<li>Esther Mamai</li>
<li>Martin Simbona</li>
<li>Jeff Mboya</li>
<li>Washington Kamadi</li>
<li>Ian Muchiri</li>
<li>Kibandi</li>
<li>Emmanuel Obara</li>
<li><p class="startli">Victoria</p>
<p class="startli">Ad Astra!! </p>
</li>
</ol>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
